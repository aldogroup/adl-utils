# ALDO Utilities

## Introduction
A set of tools that we use at the ALDO Group for our Middleman applications. Our goal is to create a common playground for centralizing our helpers and modules that we use everyday.

##### List of features

- Run Middleman as a Daemon (only unix based systems)
- Tag our Git releases
- Generate impex files for Hybris
- Cleanly restructure the build folder
- Sync with the Akamai server

## Installation

Add the following to your Gemfile:
`gem 'adl-utils', :git => 'https://github.com/aldogroup/adl-utils'`

Then simply run `bundle` to install/update the gems.

## Command Line

### Daemon
**Usage:**  
`middleman daemon [--options]`

**Options:**  
`[--start]` Run Middleman as a daemon <br />
`[--restart]` Restart the Middleman daemon <br />
`[--stop]`  Stop the Middleman daemon

**Example:**  
`middleman daemon --start`

Given this example, we boot up a Middleman daemon. You can also restart and stop the daemon.

<br />

### Rebuild

**Usage:**  
`middleman rebuild [--options]`

**Options:**  
`-e, [--environment=ENVIRONMENT]` The environment to rebuild (Default: 'dev') <br />
`-p, [--platform=PLATFORM]` The platform that we want to rebuild (icongo or hybris) (Default: 'icongo')

**Example:**  
`middleman rebuild -e prod -p hybris`

Given this example, we restructure the Hybris production build folder generated by Middleman.

<br />

### Impex

**Usage:**  
`middleman impex [--options]`  

**Options:**  
`-b` Run the Middleman build command before generating impex files <br />
`-e` Specify environment for generating impex files (Default: 'dev')

**Example:**  
`middleman impex -b -e staging`  

Given this example, Middleman will build the project and generate the impex files for our staging environment.

<br />

### Release

**Usage:**  
`middleman release [--options]`

**Options:**  
`-b` Run the Middleman build command before creating the release <br />
`-e` Specify the environment for the release (Default: 'dev') <br />
`-p` The platform that we want to release for (icongo or hybris) (Default: 'icongo')`

**Example:**  
`middleman release -b -e prod -p hybris`

Given this example, Middleman will tag a release for production on our Hybris platform.
  
<br />

### Akamai Sync

**Usage:**  
`middleman akamai_sync [--options]`

**Options:**  
`-b` Run the Middleman build command before creating the release <br />
`-e` Specify environment for generating impex files (Default: 'dev') <br />
`-p` The platform that we want to release for (icongo or hybris) (Default: 'icongo')`

**Example:**  
`middleman akamai_sync -b -e prod -p hybris`

Given this example, Middleman will sync with our Akamai server for production on our Hybris platform.
  
<br />


## Helpers

#### Price formatter

Automatically formats the price depending on the locale.

`format_price(price_value)`

#### Country conditionals
  
Helps to specify country specific logic using conditionals.

- US: `is_us`
- CA: `is_ca`
- CA-ENG: `is_ca('en')`
- CA-FRE: `is_ca('fr')`

For instance, if we want to include a module that is going to only be showcased on the US website, in our slim template, do this:

```ruby
- if is_us
	/ Include some US logic here /
```

#### Page classes

Generates classes based on the page name and current locale.

`page_class`

#### Sanitize clean

Will replace special characters with regular ones and replace spaces with dashes.

`sanitize_clean(string)`    

**Example:**
> sanitize_clean('spÃ©cial string')  
> => special-string  

`newline2br(two_line_string)`

Will check for `\n` inside the variable and replace it with a `<br />`.

**Example:**
> newline2br('this is an\nexample')  
> => this is an`<br />`example

#### Supprice

Will search for a currency and wrap it inside a `<sup>` tag.

`supprice(price)`

#### Convert class

Will remove the 'columns' string and use the integer to generate the class.

`convert_class(number of columns)`
  
**Example:**  
> convert_class('8 columns')  
> => adl-col8
   
